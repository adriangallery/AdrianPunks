<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdrianPunks Market</title>
    <link rel="icon" type="image/x-icon" href="https://marketplace-ks4ktpit5-adrians-projects-43090263.vercel.app/market/adrian1.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="config.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <!-- Incluir el menú -->
    <div id="menu-container"></div>

    <div class="container">
        <div class="nft-grid" id="nftGrid"></div>
    </div>

    <div id="nftModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <img id="modalImage" class="modal-image">
            <h2 id="modalTitle"></h2>
            <div id="modalAttributes" class="attributes"></div>
            <p id="modalCompiler"></p>
            <p id="modalMasterminds"></p>
            <p id="modalRarity"></p>
        </div>
    </div>

    <script src="components/menu.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Cargar el menú
        fetch('components/menu.html')
            .then(response => response.text())
            .then(html => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const nav = doc.querySelector('nav');
                document.getElementById('menu-container').appendChild(nav);
            })
            .catch(error => console.error('Error loading menu:', error));

        // Cargar NFTs desde el archivo JSON
        async function loadNFTs() {
            try {
                const response = await fetch('adrianpunks.json');
                if (!response.ok) {
                    throw new Error('Error al cargar los NFTs');
                }
                const data = await response.json();
                const nftGrid = document.getElementById('nftGrid');
                nftGrid.innerHTML = '';

                if (data.nfts && data.nfts.length > 0) {
                    data.nfts.forEach(nft => {
                        const nftElement = document.createElement('div');
                        nftElement.className = 'nft-item';
                        nftElement.innerHTML = `
                            <img src="${nft.image}" alt="${nft.name}" onerror="this.src='https://via.placeholder.com/300'">
                            <h3>${nft.name}</h3>
                            <p>Rareza: ${nft.rarity}</p>
                            <button onclick="showNFTDetails(${nft.id})">Ver detalles</button>
                        `;
                        nftElement.onclick = () => showNFTDetails(nft.id);
                        nftGrid.appendChild(nftElement);
                    });
                } else {
                    nftGrid.innerHTML = '<p>No se encontraron NFTs</p>';
                }
            } catch (error) {
                console.error('Error:', error);
                const nftGrid = document.getElementById('nftGrid');
                nftGrid.innerHTML = `<p>Error al cargar los NFTs: ${error.message}</p>`;
            }
        }

        // Mostrar detalles del NFT
        function showNFTDetails(nftId) {
            fetch('adrianpunks.json')
                .then(response => response.json())
                .then(data => {
                    const nft = data.nfts.find(n => n.id === nftId);
                    if (nft) {
                        const modal = document.getElementById('nftModal');
                        const modalContent = document.getElementById('nftModalContent');
                        modalContent.innerHTML = `
                            <span class="close">&times;</span>
                            <img src="${nft.image}" alt="${nft.name}" onerror="this.src='https://via.placeholder.com/300'">
                            <h2>${nft.name}</h2>
                            <p>Compilador: ${nft.compiler}</p>
                            <p>Masterminds: ${nft.masterminds.join(', ')}</p>
                            <p>Rareza: ${nft.rarity}</p>
                            <h3>Atributos:</h3>
                            <ul>
                                ${nft.attributes.map(attr => 
                                    `<li>${attr.trait_type}: ${attr.value}</li>`
                                ).join('')}
                            </ul>
                        `;
                        modal.style.display = 'block';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error al cargar los detalles del NFT');
                });
        }

        function closeModal() {
            document.getElementById('nftModal').style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('nftModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', loadNFTs);
    </script>
</body>
</html> 